<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>SQL TOURNAMENT SYSTEM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <style>
        :root {
            --accent: #00ff88; 
            --gold: #ffd700;
            --bg: #000000;
            --card: #0a0a0a;
            --border: #1a1a1a;
            --red: #ff4444;
        }

        body { margin: 0; background: var(--bg); color: #ffffff; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; overflow-x: hidden; }

        /* Header */
        header { display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; background: var(--bg); border-bottom: 1px solid var(--gold); position: sticky; top: 0; z-index: 1000; }
        .branding h1 { color: var(--gold); margin: 0; font-size: 1.3rem; font-weight: 900; letter-spacing: 1px; }
        .branding p { color: #888; margin: 0; font-size: 0.75rem; }
        .menu-icon { font-size: 1.6rem; color: var(--gold); cursor: pointer; }

        /* --- NEW GAMING BANNER --- */
        .match-banner { 
            width: 92%; 
            margin: 15px auto 5px; 
            height: 110px; 
            background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.7)), url('https://images.wallpapersden.com/image/download/garena-free-fire-battlegrounds-official_a2lsa2aUmZqaraWkpJRmbmdlrWZnZWU.jpg'); 
            background-size: cover; 
            background-position: center; 
            border-radius: 15px; 
            border: 2px solid #222; 
            display: flex; 
            flex-direction: column;
            align-items: center; 
            justify-content: center; 
            text-align: center;
        }
        .match-banner h2 { font-size: 1.1rem; color: #fff; text-shadow: 2px 2px 8px #000; letter-spacing: 2px; margin: 0; font-weight: 900; }
        .match-banner span { font-size: 0.7rem; color: var(--accent); font-weight: bold; background: rgba(0,0,0,0.6); padding: 2px 10px; border-radius: 20px; margin-top: 5px; }

        /* Side Drawer */
        #drawer { position: fixed; top: 0; right: -100%; width: 280px; height: 100%; background: #050505; border-left: 1px solid var(--gold); transition: 0.3s; z-index: 7000; padding-top: 60px; }
        #drawer.active { right: 0; }
        .close-drawer { position: absolute; top: 20px; left: 20px; font-size: 2rem; color: #fff; cursor: pointer; }
        .nav-link { display: flex; align-items: center; padding: 18px 25px; color: #fff; text-decoration: none; border-bottom: 1px solid #111; font-weight: 600; }
        .nav-link i { margin-right: 15px; color: var(--gold); width: 20px; }

        /* Match Cards */
        #matches-list { padding: 15px; }
        .match-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; margin-bottom: 20px; position: relative; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .badge { position: absolute; top: 12px; right: 12px; font-size: 0.65rem; font-weight: 800; padding: 4px 12px; border-radius: 6px; color: #000; background: var(--accent); text-transform: uppercase; }
        
        .card-body { display: flex; padding: 20px 15px; gap: 12px; }
        
        .match-details { flex: 1.2; display: flex; flex-direction: column; gap: 12px; border-right: 1px solid #1a1a1a; }
        .detail-item { display: flex; align-items: center; gap: 10px; font-size: 0.85rem; }
        .detail-item i { color: #666; width: 15px; text-align: center; }
        .detail-item span { color: #aaa; flex: 1; }
        .detail-item b { color: var(--accent); }

        .match-action { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .countdown { color: var(--gold); text-align: center; margin-bottom: 8px; }
        .time { font-size: 1.1rem; font-weight: 900; display: block; font-family: 'monospace'; }
        
        .slot-bar { width: 100%; height: 6px; background: #1a1a1a; border-radius: 10px; margin: 8px 0; overflow: hidden; }
        .slot-fill { height: 100%; background: var(--accent); transition: 1.5s ease; }

        .btn-main { background: var(--accent); color: #000; border: none; padding: 12px; border-radius: 10px; font-weight: 800; width: 100%; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 10px rgba(0, 255, 136, 0.2); }
        .room-access { background: #001a0d; border: 1px solid var(--accent); border-radius: 10px; padding: 8px; width: 100%; color: var(--accent); font-size: 0.8rem; line-height: 1.4; box-sizing: border-box; }

        /* Payment Modal */
        #pay-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 6000; display: none; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; }
        .pay-box { background: #111; padding: 25px; border: 2px solid var(--gold); border-radius: 25px; width: 100%; max-width: 400px; text-align: center; box-sizing: border-box; }
        .p-btn { background: #1a1a1a; margin: 8px 0; padding: 12px; border-radius: 12px; display: flex; align-items: center; gap: 15px; color: white; text-decoration: none; border: 1px solid #333; font-weight: bold; cursor: pointer; }
        .p-btn img { width: 25px; height: 25px; border-radius: 5px; }
        .v-input { width: 100%; padding: 12px; background: #000; border: 1px solid #444; color: #00ff88; text-align: center; border-radius: 10px; margin: 10px 0; font-weight: bold; box-sizing: border-box; outline: none; }
        .v-btn { background: #00ff88; color: black; border: none; padding: 14px; width: 100%; border-radius: 10px; font-weight: 900; cursor: pointer; }

    </style>
</head>
<body>

    <header>
        <div class="branding">
            <h1>SQL TOURNAMENT</h1>
            <p>Join Play Win Real Money ðŸ’°</p>
        </div>
        <div class="menu-icon" onclick="toggleMenu()"><i class="fas fa-bars-staggered"></i></div>
    </header>

    <div class="match-banner">
        <h2><i class="fas fa-gun"></i> BATTLEGROUNDS</h2>
        <span>FREE FIRE MOBILE TOURNAMENTS</span>
    </div>

    <div id="drawer">
        <div class="close-drawer" onclick="toggleMenu()">&times;</div>
        <a href="#" onclick="location.reload()" class="nav-link"><i class="fas fa-house"></i> HOME</a>
        <a href="#" onclick="openPolicy()" class="nav-link"><i class="fas fa-file-contract"></i> POLICY & REFUND</a>
        <a href="https://wa.me/919012277862" class="nav-link"><i class="fab fa-whatsapp"></i> WHATSAPP SUPPORT</a>
        <div id="google_translate_element" style="margin:20px;"></div>
    </div>

    <main id="matches-list"></main>

    <div id="pay-modal">
        <div class="pay-box">
            <h2 style="color:var(--gold); margin-bottom:10px;">CHECKOUT</h2>
            <p id="p-amt" style="color:#00ff88; font-weight:900; margin-bottom:15px; font-size:1.4rem;"></p>
            
            <a id="gpay" href="#" class="p-btn"><img src="https://img.icons8.com/color/48/google-pay.png"> Google Pay</a>
            <a id="ppay" href="#" class="p-btn"><img src="https://img.icons8.com/color/48/phone-pe.png"> PhonePe</a>
            <a id="paytm" href="#" class="p-btn"><img src="https://img.icons8.com/color/48/paytm.png"> Paytm</a>
            
            <input type="text" id="txid" class="v-input" placeholder="Enter Transaction ID / UTR">
            <button onclick="verifyLogic()" id="v-btn" class="v-btn">VERIFY PAYMENT</button>
            <button onclick="closePay()" style="color:var(--red); border:none; background:none; margin-top:15px; font-weight:bold; cursor:pointer; font-size: 0.9rem;">CANCEL</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBvObxADcAior6R_or9O6UmWsFT8do1GkI",
            authDomain: "sqladmin-ff04d.firebaseapp.com",
            projectId: "sqladmin-ff04d",
            storageBucket: "sqladmin-ff04d.firebasestorage.app",
            messagingSenderId: "539086978850",
            appId: "1:539086978850:web:261e6a0cf3c9a2aa29ef7b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let selectedMatchId = null;
        let checkCount = 0;

        onSnapshot(collection(db, "matches"), snap => {
            const list = document.getElementById('matches-list');
            list.innerHTML = "";
            snap.forEach(doc => {
                const data = doc.data();
                const id = doc.id;
                const localStatus = localStorage.getItem(`status_${id}`);

                let actionArea = '';
                if(localStatus === 'approved') {
                    actionArea = `<div class="room-access"><i class="fas fa-id-card"></i> ID: ${data.roomId || 'Wait...'}<br><i class="fas fa-key"></i> PS: ${data.password || 'Wait...'}</div>`;
                } else if(localStatus === 'pending') {
                    actionArea = `<div style="color:var(--gold); font-size:0.7rem; font-weight:bold;"><i class="fas fa-clock"></i> VERIFYING...</div>`;
                } else {
                    actionArea = `<button class="btn-main" onclick="openPay('${id}', ${data.entry})"><i class="fas fa-play"></i> JOIN NOW</button>`;
                }

                list.innerHTML += `
                <div class="match-card">
                    <div class="badge">${data.status}</div>
                    <div class="card-body">
                        <div class="match-details">
                            <div class="detail-item"><i class="fas fa-map"></i><span>Map</span> <b>${data.map}</b></div>
                            <div class="detail-item"><i class="fas fa-user-group"></i><span>Type</span> <b>${data.type}</b></div>
                            <div class="detail-item"><i class="fas fa-wallet"></i><span>Entry</span> <b>â‚¹${data.entry}</b></div>
                            <div class="detail-item"><i class="fas fa-trophy"></i><span>Prize</span> <b>â‚¹${data.win}</b></div>
                        </div>
                        <div class="match-action">
                            <div class="countdown" id="timer-${id}"><small>Starts In</small><span class="time">00:00</span></div>
                            <div class="slot-bar"><div class="slot-fill" style="width:${(data.joined/data.total)*100}%"></div></div>
                            <div style="font-size:0.7rem; color:#666; margin-bottom:10px;">${data.joined}/${data.total} Slots Filled</div>
                            ${actionArea}
                        </div>
                    </div>
                </div>`;
            });
        });

        window.openPay = (id, amt) => {
            selectedMatchId = id;
            checkCount = 0;
            document.getElementById('pay-modal').style.display = 'flex';
            document.getElementById('p-amt').innerText = "Total: â‚¹" + amt;
            
            const upi = `upi://pay?pa=rizwanhasan90122778623@ybl&am=${amt}&cu=INR&tn=SQL_Tournament_${id}`;
            document.getElementById('gpay').href = upi;
            document.getElementById('ppay').href = upi;
            document.getElementById('paytm').href = upi;

            const b = document.getElementById('v-btn');
            b.innerText = "VERIFY PAYMENT"; 
            b.style.background = "#00ff88";
        };

        window.verifyLogic = async () => {
            const utr = document.getElementById('txid').value;
            if(!utr) return alert("Error: Please enter UTR/Transaction ID!");

            const b = document.getElementById('v-btn');
            b.innerText = "PROCESSING... â³";
            
            setTimeout(async () => {
                if(checkCount === 0) {
                    b.innerText = "MANUAL CHECK NEEDED âš ï¸ SEND SCREENSHOT";
                    b.style.background = "orange";
                    checkCount++;
                    
                    await addDoc(collection(db, "payments"), {
                        matchId: selectedMatchId,
                        utr: utr,
                        status: 'pending',
                        timestamp: Date.now()
                    });
                    localStorage.setItem(`status_${selectedMatchId}`, 'pending');

                } else {
                    const res = ["PAYMENT PENDING â³", "VERIFYING... â³", "MANUAL CHECK NEEDED âš ï¸"];
                    const finalMsg = res[Math.floor(Math.random()*res.length)];
                    b.innerText = finalMsg;
                    b.style.background = "orange";
                }
            }, 2000);
        };

        window.closePay = () => document.getElementById('pay-modal').style.display = 'none';

    </script>

    <script>
        function toggleMenu() { document.getElementById('drawer').classList.toggle('active'); }
        function openPolicy() { 
            alert("SQL REFUND POLICY:\n\n1. Match cancel hone par 30 minat ke andar refund milega.\n2. Hacks use karne par entry fee wapas nahi hogi.\n3. Problem hone par WhatsApp par screenshot bhejein."); 
        }
        function googleTranslateElementInit() { new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element'); }
    </script>
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
    </html>

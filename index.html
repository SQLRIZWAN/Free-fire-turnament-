<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FREE FIRE TOURNAMENT</title>

<!-- Firebase (modular) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
  import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, collection, onSnapshot, addDoc, query, where, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // ---------- YOUR FIREBASE CONFIG (you provided) ----------
  const firebaseConfig = {
    apiKey: "AIzaSyBvObxADcAior6R_or9O6UmWsFT8do1GkI",
    authDomain: "sqladmin-ff04d.firebaseapp.com",
    projectId: "sqladmin-ff04d",
    storageBucket: "sqladmin-ff04d.firebasestorage.app",
    messagingSenderId: "539086978850",
    appId: "1:539086978850:web:261e6a0cf3c9a2aa29ef7b",
    measurementId: "G-KH4J0CZ9M5"
  };
  const app = initializeApp(firebaseConfig);
  try { getAnalytics(app); } catch(e){ /* analytics optional */ }
  const auth = getAuth(app);
  const db = getFirestore(app);

  // ---------- App State ----------
  window.currentMatch = null;
  window.currentUser = null;
  window.lang = 'en'; // 'en' | 'hi' | 'ur'  (simple toggle translations)

  // ---------- Utilities ----------
  function $(s){ return document.querySelector(s); }
  function setText(sel, txt){ const el = document.querySelector(sel); if(el) el.innerText = txt; }
  function formatRupee(n){ return (isNaN(n)||n===undefined)? '‚Äî' : '‚Çπ' + Number(n); }

  // small translator (few labels)
  const T = {
    en: {
      join: "JOIN MATCH",
      waiting: "waiting",
      upcoming: "upcoming",
      live: "live",
      submit_payment: "SUBMIT PAYMENT",
      enter_utr: "Enter Transaction ID (UTR)",
      pay_via_upi: "Pay via UPI & enter UTR",
      complete_payment: "Complete Payment",
      cancel: "Cancel",
      join_play_win: "Join ‚Ä¢ Play ‚Ä¢ Win Real Cash",
      refund_note: "Refunds processed within 20 minutes.",
      policy_text: "This game involves risk. Play at your own risk. Refunds processed within 20 minutes."
    },
    hi: {
      join: "‡§Æ‡•à‡§ö ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç",
      waiting: "‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ",
      upcoming: "‡§ú‡§≤‡•ç‡§¶ ‡§∂‡•Å‡§∞‡•Ç",
      live: "‡§≤‡§æ‡§á‡§µ",
      submit_payment: "‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç",
      enter_utr: "‡§≤‡•á‡§®-‡§¶‡•á‡§® ‡§Ü‡§à‡§°‡•Ä ‡§°‡§æ‡§≤‡•á‡§Ç (UTR)",
      pay_via_upi: "UPI ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ UTR ‡§°‡§æ‡§≤‡•á‡§Ç",
      complete_payment: "‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç",
      cancel: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
      join_play_win: "‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‚Ä¢ ‡§ñ‡•á‡§≤‡•á‡§Ç ‚Ä¢ ‡§Ö‡§∏‡§≤‡•Ä ‡§®‡§ï‡§¶ ‡§ú‡•Ä‡§§‡•á‡§Ç",
      refund_note: "‡§∞‡§ø‡§´‡§Ç‡§° 20 ‡§Æ‡§ø‡§®‡§ü ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§",
      policy_text: "‡§Ø‡§π ‡§ó‡•á‡§Æ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§æ ‡§π‡•à‡•§ ‡§Ö‡§™‡§®‡•á ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡§∞ ‡§ñ‡•á‡§≤‡•á‡§Ç‡•§ ‡§∞‡§ø‡§´‡§Ç‡§° 20 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡•§"
    },
    ur: {
      join: "ŸÖ€å⁄Ü ŸÖ€å⁄∫ ÿ¥ÿßŸÖŸÑ €ÅŸà⁄∫",
      waiting: "ÿßŸÜÿ™ÿ∏ÿßÿ±",
      upcoming: "ÿ¨ŸÑÿØ ÿ¥ÿ±Ÿàÿπ",
      live: "ŸÑÿßÿ¶€åŸà",
      submit_payment: "ÿßÿØÿßÿ¶€å⁄Ø€å ÿ¨ŸÖÿπ ⁄©ÿ±€å⁄∫",
      enter_utr: "Ÿπÿ±€å⁄©ŸÜ⁄©ÿ¥ŸÜ ÿ¢ÿ¶€å ⁄à€å ÿØÿ±ÿ¨ ⁄©ÿ±€å⁄∫ (UTR)",
      pay_via_upi: "UPI ⁄©€í ÿ∞ÿ±€åÿπ€í ÿßÿØÿßÿ¶€å⁄Ø€å ⁄©ÿ±€å⁄∫ ÿßŸàÿ± UTR ÿØÿ±ÿ¨ ⁄©ÿ±€å⁄∫",
      complete_payment: "ÿßÿØÿßÿ¶€å⁄Ø€å ŸÖ⁄©ŸÖŸÑ ⁄©ÿ±€å⁄∫",
      cancel: "ŸÖŸÜÿ≥ŸàÿÆ ⁄©ÿ±€å⁄∫",
      join_play_win: "ÿ¥ÿßŸÖŸÑ €ÅŸà⁄∫ ‚Ä¢ ⁄©⁄æ€åŸÑ€å⁄∫ ‚Ä¢ ÿßÿµŸÑ€å ŸÜŸÇÿØ ÿ¨€åÿ™€å⁄∫",
      refund_note: "ÿ±ŸÇŸÖ 20 ŸÖŸÜŸπ ⁄©€í ÿßŸÜÿØÿ± ÿ¨ŸÖÿπ ⁄©ÿ± ÿØ€å ÿ¨ÿßÿ™€å €Å€í€î",
      policy_text: "€å€Å ⁄©⁄æ€åŸÑ ÿÆÿ∑ÿ±€í ÿ≥€í ŸÖŸÜÿ≥ŸÑ⁄© €Å€í€î ÿßŸæŸÜ€í ÿÆÿ∑ÿ±€í Ÿæÿ± ⁄©⁄æ€åŸÑ€å⁄∫€î ÿ±€åŸÅŸÜ⁄à 20 ŸÖŸÜŸπ ŸÖ€å⁄∫ Ÿæÿ±Ÿàÿ≥€åÿ≥€î"
    }
  };

  function t(k){ return (T[window.lang] && T[window.lang][k]) || T.en[k] || k; }

  // ---------- Auth handling ----------
  onAuthStateChanged(auth, user => {
    window.currentUser = user;
    // update UI
    if(user){
      $('#user-email').innerText = user.email || 'User';
      $('#btn-login').style.display = 'none';
      $('#btn-logout').style.display = 'inline-block';
    } else {
      $('#user-email').innerText = '';
      $('#btn-login').style.display = 'inline-block';
      $('#btn-logout').style.display = 'none';
    }
  });

  window.showLogin = () => {
    $('#login-modal').style.display = 'flex';
  };
  window.hideLogin = () => { $('#login-modal').style.display = 'none'; };
  window.login = async () => {
    const em = $('#login-email').value.trim();
    const pw = $('#login-pass').value;
    if(!em || !pw) return alert('Enter email + password');
    try{
      await signInWithEmailAndPassword(auth, em, pw);
      hideLogin();
      alert('Logged in');
    }catch(e){
      // Try sign up if not found? Prompt user.
      if(confirm('Login failed. Create new account with these credentials?')){
        try{
          await createUserWithEmailAndPassword(auth, em, pw);
          hideLogin();
          alert('Account created and signed in.');
        }catch(er){ alert('Error: ' + er.message); }
      } else alert('Login error: ' + e.message);
    }
  };
  window.doLogout = async () => {
    await signOut(auth);
    alert('Logged out');
  };

  // ---------- Matches listener ----------
  function renderStatusLabel(status){
    const s = (''+status).toLowerCase();
    if(s.includes('live') || s.includes('running') || s.includes('started') || s.includes('approved')) return `<span class="status tag green">${status}</span>`;
    if(s.includes('upcom') || s.includes('upcoming')) return `<span class="status tag gold">${status}</span>`;
    if(s.includes('wait') || s.includes('pending')) return `<span class="status tag faded">${status}</span>`;
    return `<span class="status tag faded">${status}</span>`;
  }

  function startMatchesListener(){
    const col = collection(db, 'matches');
    onSnapshot(col, snap => {
      const box = $('#matches');
      box.innerHTML = '';
      snap.forEach(d => {
        const m = d.data();
        const docId = d.id;
        // defaults
        const entry = m.entry ?? m.entryFee ?? 0;
        const win = m.win ?? m.winAmount ?? 0;
        const joined = Number(m.joinedPlayers ?? 0);
        const maxPlayers = Number(m.maxPlayers ?? m.slots ?? 0);
        const joinEnabled = (m.joinEnabled === undefined ? true : !!m.joinEnabled);
        const now = Date.now();
        // timer if startTimestamp field present
        let timerHtml = '';
        if(m.startTimestamp){
          const diff = Number(m.startTimestamp) - now;
          timerHtml = `<div class="timer" data-start="${m.startTimestamp}" id="timer-${docId}">${diff>0?msToTime(diff):'Starting'}</div>`;
        } else if(m.durationMinutes){
          // optional: compute later
        }
        // decide join button state
        const full = maxPlayers && (joined >= maxPlayers);
        const showJoin = joinEnabled && !full && !(m.status && m.status.toLowerCase().includes('started'));
        const joinBtn = showJoin ? `<button class="join-btn" data-id="${docId}" data-amt="${entry}">${t('join')}</button>` : `<button class="join-btn disabled" disabled>${full ? 'Full' : 'Join Closed'}</button>`;

        // room display: show only if payment approved OR match status approved/live
        const showRoom = (m.roomId && m.password && (m.status && (m.status.toLowerCase().includes('approved') || m.status.toLowerCase().includes('started') || m.status.toLowerCase().includes('live'))));
        const roomHtml = showRoom ? `<div class="room"><strong>Room ID:</strong> ${m.roomId}<br/><strong>Password:</strong> ${m.password}</div>` : `<div class="room waiting"><em>Room: ${t('waiting')} ‚Äî payment approval required</em></div>`;

        // card
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="card-left">
            <h3 class="mtype">${m.type ?? docId}</h3>
            <p><strong>Entry:</strong> ${formatRupee(entry)}</p>
            <p><strong>Win:</strong> ${formatRupee(win)}</p>
            <p><strong>Players:</strong> <span class="players-count">${joined}</span> / <span class="players-max">${maxPlayers||'‚Äî'}</span></p>
            <p><strong>Status:</strong> ${renderStatusLabel(m.status ?? 'waiting')}</p>
            ${timerHtml}
          </div>
          <div class="card-right">
            ${roomHtml}
            ${joinBtn}
          </div>
        `;
        box.appendChild(card);
      });

      // attach join button listeners (delegation)
      document.querySelectorAll('.join-btn').forEach(b=>{
        if(!b.classList.contains('disabled')){
          b.onclick = (ev)=>{
            const id = b.getAttribute('data-id');
            const amt = b.getAttribute('data-amt');
            // require login
            if(!window.currentUser){
              if(confirm('You must login to join. Go to login?')) showLogin();
              return;
            }
            // set currentMatch and open payment modal
            window.currentMatch = { id, amt: Number(amt) };
            openPay(Number(amt));
          };
        }
      });

      // start timers
      document.querySelectorAll('.timer').forEach(el=>{
        const start = Number(el.dataset.start);
        const id = el.id;
        if(window[id]) clearInterval(window[id]);
        window[id] = setInterval(()=> {
          const diff = start - Date.now();
          el.innerText = diff>0 ? msToTime(diff) : 'Starting';
          if(diff<=0) clearInterval(window[id]);
        }, 800);
      });

    }, err => {
      console.error('matches snapshot error', err);
    });
  } // end startMatchesListener

  // convert ms to hh:mm:ss or mm:ss
  function msToTime(ms){
    if(ms<=0) return '00:00';
    let s = Math.floor(ms/1000);
    const h = Math.floor(s/3600);
    s = s%3600;
    const m = Math.floor(s/60);
    const sec = s%60;
    if(h>0) return `${h}:${m.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
    return `${m.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
  }

  // ---------- Payment Modal (styled) ----------
  // UPI address (you gave earlier) - used for gpay/phonepe/paytm
  const UPI_ADDR = 'rizwanhasan90122778623@ybl';

  window.openPay = (amt) => {
    $('#pay-modal').style.display = 'flex';
    $('#p-amt').innerText = `Total: ‚Çπ${amt}`;
    const upi = `upi://pay?pa=${encodeURIComponent(UPI_ADDR)}&am=${amt}&cu=INR`;
    $('#gpay').href = upi;
    $('#ppay').href = upi;
    $('#paytm').href = upi;
    $('#txid').value = '';
    $('#v-btn').innerText = t('submit_payment');
    $('#v-btn').style.background = '#00ff88';
  };
  window.closePay = () => { $('#pay-modal').style.display = 'none'; };

  window.copyA = (a, t) => {
    navigator.clipboard.writeText(a);
    alert(t + ' Address Copied!');
  };

  // On submit payment: create payments doc then navigate to payment status "page"
  window.submitPayment = async () => {
    const tx = $('#txid').value.trim();
    if(!tx) return alert(t('enter_utr'));
    if(!window.currentUser) return alert('Login required.');
    // create payments doc
    try{
      const pcol = collection(db, 'payments');
      const docRef = await addDoc(pcol, {
        matchId: window.currentMatch.id,
        uid: window.currentUser.uid,
        email: window.currentUser.email,
        amount: Number(window.currentMatch.amt),
        utr: tx,
        status: 'pending',
        createdAt: Date.now()
      });
      closePay();
      // open payment status view (stable)
      window.location.hash = '#payment-' + docRef.id;
      showPaymentStatus(docRef.id);
    }catch(e){ alert('Error submitting payment: ' + e.message); }
  };

  // ---------- Payment Status View ----------
  async function showPaymentStatus(paymentId){
    if(!paymentId) return;
    // switch view
    $('#home-view').style.display = 'none';
    $('#status-view').style.display = 'block';
    $('#status-payment-id').innerText = paymentId;
    // listen payment doc
    const dref = doc(db, 'payments', paymentId);
    onSnapshot(dref, snap => {
      if(!snap.exists()) { $('#status-body').innerText = 'No payment found'; return;}
      const p = snap.data();
      $('#status-body').innerHTML = `
        <p><strong>Match:</strong> ${p.matchId}</p>
        <p><strong>Amount:</strong> ${formatRupee(p.amount)}</p>
        <p><strong>UTR:</strong> ${p.utr}</p>
        <p><strong>Status:</strong> ${p.status}</p>
      `;
      if(p.status === 'approved'){
        // fetch match doc to show room
        getDoc(doc(db,'matches', p.matchId)).then(md=>{
          if(md.exists()){
            const mm = md.data();
            $('#status-room').innerHTML = `<div class="room approved"><strong>Room ID: </strong>${mm.roomId || '‚Äî'}<br/><strong>Password: </strong>${mm.password || '‚Äî'}</div>`;
          }
        }).catch(()=>{});
      } else {
        $('#status-room').innerHTML = `<div class="room waiting"><em>Room will show after admin approval</em></div>`;
      }
    });
  }

  // On load: start matches listener and route handling
  window.addEventListener('load', ()=>{
    startMatchesListener();
    // hash routing for payment view
    if(location.hash && location.hash.startsWith('#payment-')){
      const pid = location.hash.replace('#payment-','');
      showPaymentStatus(pid);
    }
    // translation toggle UI text
    updateStaticText();
  });

  // simple language switch
  window.setLang = (L) => {
    window.lang = L;
    updateStaticText();
  };
  function updateStaticText(){
    $('.subtitle').innerText = t('join_play_win');
    $('#copyright').innerText = `¬© 2026 SQL ‚Äî Premium Tournament System`;
    // translate modal buttons
    $('#v-btn').innerText = t('submit_payment');
    $('#p-amt').innerText = $('#p-amt').innerText || '';
    // policy text displayed in menu
    $('#policy-text').innerText = t('policy_text');
  }

  // small helper to navigate home
  window.goHome = () => {
    $('#home-view').style.display = 'block';
    $('#status-view').style.display = 'none';
    location.hash = '';
  };

  // WhatsApp link
  window.openWhatsApp = () => {
    const num = '+919012277862';
    window.open('https://wa.me/' + num.replace('+',''), '_blank');
  };

</script>

<style>
  :root{
    --bg:#050505;
    --card:#0f0f0f;
    --muted:#999;
    --gold:#f6c21a;
    --accent:#00ff88;
    --green:#00d25b;
    --dark:#0b0b0b;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:Inter,Arial,Helvetica,sans-serif}
  header{padding:20px 16px;border-bottom:2px solid var(--gold);display:flex;align-items:center;justify-content:space-between;gap:12px}
  .logo {font-size:28px;font-weight:900;color:var(--gold);letter-spacing:1px}
  .subtitle{color:var(--muted);margin-top:4px;font-size:14px}
  #menu-btn{background:transparent;border:none;color:var(--accent);font-size:28px;padding:8px;cursor:pointer}
  main{padding:18px;max-width:720px;margin:0 auto}
  #matches{padding-top:4px}
  .card{background:var(--card);border-radius:14px;padding:18px;margin-bottom:18px;display:flex;justify-content:space-between;gap:12px;align-items:flex-start;box-shadow:0 6px 18px rgba(0,0,0,0.6)}
  .card-left{flex:1}
  .card-right{width:250px;min-width:200px;text-align:right}
  .mtype{color:var(--accent);margin:0 0 10px 0}
  .card p{margin:6px 0;color:#ddd}
  .tag{padding:6px 8px;border-radius:8px;font-weight:700}
  .tag.green{background:rgba(0,210,91,0.08);color:var(--green);border:1px solid rgba(0,210,91,0.12)}
  .tag.gold{background:rgba(246,194,26,0.06);color:var(--gold);border:1px solid rgba(246,194,26,0.12)}
  .tag.faded{background:rgba(255,255,255,0.02);color:#bbb;border:1px solid rgba(255,255,255,0.03)}
  .room{background:#070707;padding:10px;border-radius:8px;color:var(--accent);margin-bottom:10px;text-align:left}
  .room.waiting{color:#aaa}
  .join-btn{display:inline-block;width:100%;background:var(--gold);color:#000;padding:10px;border-radius:10px;border:none;font-weight:900;cursor:pointer}
  .join-btn.disabled{opacity:0.45;cursor:not-allowed}
  .timer{margin-top:8px;color:#ddd;font-weight:700}

  /* menu (right side drawer) */
  #drawer{position:fixed;right:0;top:0;height:100%;width:0;background:#070707;color:#fff;overflow:hidden;transition:width .22s;box-shadow:-6px 0 24px rgba(0,0,0,0.8);z-index:9999;padding-top:80px}
  #drawer.open{width:320px}
  #drawer .menu-inner{padding:20px}
  .menu-item{padding:14px 10px;border-radius:8px;margin-bottom:12px;display:flex;align-items:center;gap:12px;cursor:pointer}
  .menu-item:hover{background:rgba(255,255,255,0.02)}
  .icon{width:34px;height:34px;border-radius:6px;background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center;color:var(--accent)}
  .menu-title{font-weight:700}
  #policy-text{color:var(--muted);padding:10px 0}

  /* payment modal (your style, cleaned: no BTC/USDT) */
  #pay-modal{position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.98);display:none;align-items:center;justify-content:center;padding:20px;z-index:10000}
  .pay-box{background:#111;padding:25px;border:2px solid var(--gold);border-radius:22px;width:100%;max-width:420px;text-align:center}
  .p-btn{background:#1a1a1a;margin:10px 0;padding:12px;border-radius:12px;display:flex;align-items:center;gap:15px;color:white;text-decoration:none;border:1px solid #333;font-weight:bold;cursor:pointer}
  .p-btn img{width:28px;height:28px;border-radius:5px}
  .v-input{width:100%;padding:12px;background:#000;border:1px solid #444;color:var(--accent);text-align:center;border-radius:10px;margin:10px 0;font-weight:bold}
  .v-btn{background:var(--accent);color:black;border:none;padding:14px;width:100%;border-radius:10px;font-weight:900;cursor:pointer}
  .close-small{background:none;border:none;color:#f55;margin-top:12px;cursor:pointer}

  /* status view */
  #status-view{display:none;padding:20px;max-width:720px;margin:0 auto}
  #status-body{background:var(--card);padding:16px;border-radius:12px}

  footer{padding:20px;text-align:center;color:#777;border-top:1px solid rgba(255,255,255,0.02)}
  .small{font-size:13px;color:#9a9a9a}

  /* login modal */
  #login-modal{position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:none;align-items:center;justify-content:center;z-index:10001}
  .login-box{background:#111;padding:22px;border-radius:12px;border:2px solid var(--gold);max-width:360px;width:100%;text-align:center}
  .login-box input{width:100%;padding:10px;margin:8px 0;border-radius:8px;background:#000;color:var(--accent);border:1px solid #333}

  @media (max-width:600px){
    #drawer{width:0}
    #drawer.open{width:100%}
    .card-right{width:40%}
  }
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div>
    <div class="logo">FREE FIRE TOURNAMENT</div>
    <div class="subtitle">Join ‚Ä¢ Play ‚Ä¢ Win Real Cash</div>
  </div>
  <div style="display:flex;gap:12px;align-items:center">
    <div id="user-email" style="font-weight:700;color:var(--accent)"></div>
    <button id="btn-login" onclick="showLogin()" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--accent);padding:8px;border-radius:8px">Login</button>
    <button id="btn-logout" onclick="doLogout()" style="display:none;background:#ff4d4d;border:none;padding:8px;border-radius:8px;color:#fff">Logout</button>
    <button id="menu-btn" onclick="document.getElementById('drawer').classList.toggle('open')">‚ò∞</button>
  </div>
</header>

<!-- DRAWER menu (right) -->
<div id="drawer" aria-hidden="true">
  <div class="menu-inner">
    <div class="menu-item" onclick="goHome();document.getElementById('drawer').classList.remove('open')">
      <div class="icon">üè†</div><div><div class="menu-title">Home</div><div class="small">Return to matches</div></div>
    </div>

    <div class="menu-item" onclick="document.getElementById('policy-modal').style.display='block'">
      <div class="icon">üìú</div><div><div class="menu-title">Policy</div><div class="small">Game risks & refunds</div></div>
    </div>

    <div class="menu-item" onclick="openWhatsApp()">
      <div class="icon">üí¨</div><div><div class="menu-title">WhatsApp</div><div class="small">+91 9012277862</div></div>
    </div>

    <div class="menu-item" onclick="setLang('en')">
      <div class="icon">EN</div><div><div class="menu-title">English</div></div>
    </div>
    <div class="menu-item" onclick="setLang('hi')">
      <div class="icon">HI</div><div><div class="menu-title">Hindi (Roman)</div></div>
    </div>
    <div class="menu-item" onclick="setLang('ur')">
      <div class="icon">UR</div><div><div class="menu-title">Urdu (Roman)</div></div>
    </div>

    <div class="menu-item" onclick="document.getElementById('drawer').classList.remove('open'); showLogin()">
      <div class="icon">üîë</div><div><div class="menu-title">Login</div><div class="small">Sign in / create account</div></div>
    </div>

    <div id="policy-text" style="margin-top:20px;color:var(--muted)">Policy text here</div>
  </div>
</div>

<!-- MAIN / HOME VIEW -->
<div id="home-view">
  <main>
    <div id="matches"></div>
    <footer><div id="copyright">¬© 2026 SQL ‚Äî Premium Tournament System</div><div class="small">¬© All rights reserved</div></footer>
  </main>
</div>

<!-- PAYMENT MODAL (styled) -->
<div id="pay-modal">
  <div class="pay-box">
    <h2 style="color:var(--gold); margin-bottom:10px;">CHECKOUT</h2>
    <p id="p-amt" style="color:var(--accent); font-weight:900; margin-bottom:15px; font-size:1.2rem;"></p>

    <a id="gpay" href="#" class="p-btn"><img src="https://img.icons8.com/color/48/google-pay.png" alt="gpay"/> Google Pay</a>
    <a id="ppay" href="#" class="p-btn"><img src="https://img.icons8.com/color/48/phone-pe.png" alt="phonepe"/> PhonePe</a>
    <a id="paytm" href="#" class="p-btn"><img src="https://img.icons8.com/color/48/paytm.png" alt="paytm"/> Paytm</a>

    <div style="height:12px"></div>
    <input id="txid" class="v-input" placeholder="Enter Transaction ID (UTR)"/>
    <button id="v-btn" class="v-btn" onclick="submitPayment()">SUBMIT PAYMENT</button>
    <button class="close-small" onclick="closePay()">CANCEL</button>
  </div>
</div>

<!-- Payment status page (stable) -->
<div id="status-view">
  <main style="max-width:720px;margin:30px auto">
    <h2>Payment Status</h2>
    <div id="status-body" style="margin-bottom:12px"></div>
    <div id="status-room"></div>
    <div style="margin-top:18px"><button onclick="goHome()" style="padding:10px 12px;border-radius:8px;background:var(--gold);border:none;font-weight:700">Back to matches</button></div>
  </main>
</div>

<!-- LOGIN MODAL -->
<div id="login-modal">
  <div class="login-box">
    <h3 style="color:var(--gold)">Account</h3>
    <input id="login-email" placeholder="Email" />
    <input id="login-pass" type="password" placeholder="Password" />
    <div style="display:flex;gap:8px;margin-top:8px">
      <button onclick="login()" style="flex:1;background:var(--accent);border:none;padding:10px;border-radius:8px;font-weight:800">Sign in / Sign up</button>
      <button onclick="hideLogin()" style="flex:1;background:#222;border:none;padding:10px;border-radius:8px">Cancel</button>
    </div>
  </div>
</div>

<!-- POLICY Modal -->
<div id="policy-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:12000;align-items:center;justify-content:center;padding:20px">
  <div style="background:#111;padding:20px;border-radius:12px;border:2px solid var(--gold);max-width:640px;margin:40px auto">
    <h2 style="color:var(--gold)">Policy</h2>
    <p id="policy-text" style="color:#ddd">Policy text placeholder</p>
    <p style="color:var(--muted)"><strong>Refund:</strong> Refunds processed within 20 minutes.</p>
    <div style="margin-top:12px;text-align:right">
      <button onclick="document.getElementById('policy-modal').style.display='none'" style="padding:8px 12px;border-radius:8px;background:#222;border:none;color:#fff">Close</button>
    </div>
  </div>
</div>

<!-- Scripts: small helpers loaded earlier are in module -->
<script>
  // small DOM utilities available in module as well: but for safety attach $
  window.$ = (s)=> document.querySelector(s);

  // Close drawer by clicking outside
  document.addEventListener('click', (e)=>{
    const drawer = document.getElementById('drawer');
    const menuBtn = document.getElementById('menu-btn');
    if(drawer.classList.contains('open')){
      // if clicked outside drawer and not menu button
      if(!drawer.contains(e.target) && e.target !== menuBtn){
        drawer.classList.remove('open');
      }
    }
  });

  // simple hash routing: if user opens direct payment hash
  window.addEventListener('hashchange', ()=>{
    if(location.hash && location.hash.startsWith('#payment-')){
      const pid = location.hash.replace('#payment-','');
      // call function from module - we defined showPaymentStatus there
      if(window.showPaymentStatus) window.showPaymentStatus(pid);
    } else {
      // go home
      if(window.goHome) window.goHome();
    }
  });
</script>

</body>
  </html>

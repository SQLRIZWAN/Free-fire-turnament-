<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>SQL Premium Tournament</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

    <style>
        :root {
            --primary: #00ff88; 
            --gold: #ffd700;
            --bg: #050505;
            --card-bg: #111;
            --danger: #ff4444;
        }

        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Segoe UI', Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }

        /* Banner Slider Style */
        .banner-container { width: 100%; height: 160px; overflow: hidden; position: relative; border-bottom: 2px solid var(--gold); }
        .banner-slide { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.7); }

        header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: rgba(0,0,0,0.9); position: sticky; top: 0; z-index: 100; backdrop-filter: blur(10px); }
        header h1 { color: var(--gold); margin: 0; font-size: 1.1rem; letter-spacing: 2px; text-shadow: 0 0 10px rgba(255,215,0,0.3); }

        /* Side Menu */
        #side-menu {
            position: fixed; top: 0; right: -100%; width: 260px; height: 100%;
            background: #0d0d0d; border-left: 2px solid var(--gold);
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); z-index: 200; padding-top: 50px;
        }
        #side-menu.active { right: 0; }
        .close-btn { position: absolute; top: 15px; left: 15px; font-size: 1.8rem; color: #fff; cursor: pointer; }

        .menu-item { display: flex; align-items: center; padding: 15px 20px; color: #eee; text-decoration: none; border-bottom: 1px solid #1a1a1a; font-size: 0.95rem; }
        .menu-item i { width: 30px; color: var(--gold); font-size: 1.1rem; }
        #google_translate_element { padding: 15px; }

        /* Match Cards */
        #matches { padding: 15px; display: grid; gap: 15px; }
        .card { background: var(--card-bg); border-radius: 12px; border: 1px solid #222; overflow: hidden; }
        
        .card-top { background: #1a1a1a; padding: 8px 12px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #282828; }
        .status-tag { font-size: 0.7rem; font-weight: 800; padding: 3px 10px; border-radius: 4px; color: #000; background: var(--primary); }

        .card-content { display: flex; padding: 15px; gap: 10px; }
        .left-data { flex: 1.2; }
        .right-data { flex: 1; text-align: center; border-left: 1px solid #222; padding-left: 10px; }

        .data-row { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.85rem; color: #999; }
        .data-row b { color: var(--primary); }

        .timer-box { color: var(--gold); font-weight: bold; font-size: 1rem; margin-bottom: 10px; }
        .timer-box small { display: block; font-size: 0.6rem; color: #666; text-transform: uppercase; }

        .slot-info { font-size: 0.7rem; color: #888; margin-top: 5px; }
        .progress-bar { width: 100%; height: 5px; background: #222; border-radius: 10px; margin: 5px 0; }
        .progress-fill { height: 100%; background: var(--primary); border-radius: 10px; transition: 0.5s; }

        .btn-join { 
            background: linear-gradient(to bottom, #00ff88, #00cc6e); color: #000; 
            border: none; padding: 10px; border-radius: 6px; font-weight: bold; width: 100%; 
            cursor: pointer; font-size: 0.85rem; margin-top: 5px;
        }

        /* Payment Modal */
        #pay-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 300; display: none; align-items: center; justify-content: center; }
        .pay-box { background: #111; border: 1px solid var(--gold); border-radius: 15px; width: 85%; max-width: 340px; padding: 20px; text-align: center; }
        .qr-img { width: 180px; height: 180px; background: #fff; margin: 15px auto; border-radius: 10px; display: flex; align-items: center; justify-content: center; color: #000; font-size: 0.8rem; }
        
        input { width: 90%; padding: 12px; margin: 10px 0; background: #000; border: 1px solid #333; color: var(--primary); border-radius: 8px; text-align: center; outline: none; font-family: monospace; }
        .btn-submit { background: var(--gold); color: #000; border: none; padding: 12px; width: 100%; border-radius: 8px; font-weight: bold; cursor: pointer; }

        .room-info { background: #000; border: 1px solid var(--primary); border-radius: 8px; padding: 10px; margin-top: 10px; animation: glow 1.5s infinite; }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 5px var(--primary); } 50% { box-shadow: 0 0 15px var(--primary); } }
        
        .whatsapp-float { position: fixed; bottom: 20px; left: 20px; background: #25d366; color: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); z-index: 99; }

    </style>
</head>
<body>

    <div class="banner-container">
        <img src="https://wallpaperaccess.com/full/1151163.jpg" alt="Free Fire Banner" class="banner-slide">
    </div>

    <header>
        <h1>SQL TOURNAMENT</h1>
        <div onclick="toggleMenu()" style="color:var(--gold); font-size:1.4rem; cursor:pointer;"><i class="fas fa-bars"></i></div>
    </header>

    <div id="side-menu">
        <div class="close-btn" onclick="toggleMenu()">&times;</div>
        <a href="#" onclick="location.reload()" class="menu-item"><i class="fas fa-home"></i> HOME</a>
        <a href="#" onclick="showPolicy()" class="menu-item"><i class="fas fa-shield-alt"></i> REFUND POLICY</a>
        <a href="https://wa.me/919012277862" class="menu-item"><i class="fab fa-whatsapp"></i> CONTACT ADMIN</a>
        
        <p style="padding:15px 20px 0 20px; font-size:0.7rem; color:#555; margin:0;">SELECT LANGUAGE:</p>
        <div id="google_translate_element"></div>
    </div>

    <div id="matches">
        </div>

    <a href="https://wa.me/919012277862" class="whatsapp-float"><i class="fab fa-whatsapp"></i></a>

    <div id="pay-modal">
        <div class="pay-box">
            <h3 style="color:var(--gold); margin:0;">COMPLETE PAYMENT</h3>
            <p style="font-size:0.8rem; color:#aaa;">Amount to Pay: <b id="p-amt" style="color:var(--primary);">₹0</b></p>
            
            <div class="qr-img">
                <i class="fas fa-qrcode fa-5x"></i>
            </div>
            
            <input type="text" id="utr-field" placeholder="ENTER 12-DIGIT UTR NO." maxlength="12">
            <button class="btn-submit" onclick="submitUTR()">SUBMIT PAYMENT</button>
            <button onclick="closePay()" style="background:none; border:none; color:#666; margin-top:10px; cursor:pointer;">Cancel</button>
        </div>
    </div>

    <footer style="text-align:center; padding:30px; color:#333; font-size:0.7rem;">
        © 2026 SQL PREMIUM SYSTEM — V4.0 STABLE
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, addDoc, query, where } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBvObxADcAior6R_or9O6UmWsFT8do1GkI",
            authDomain: "sqladmin-ff04d.firebaseapp.com",
            projectId: "sqladmin-ff04d",
            storageBucket: "sqladmin-ff04d.firebasestorage.app",
            messagingSenderId: "539086978850",
            appId: "1:539086978850:web:261e6a0cf3c9a2aa29ef7b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let activeMatchId = null;

        // Fetch Matches
        onSnapshot(collection(db, "matches"), snap => {
            const container = document.getElementById('matches');
            container.innerHTML = "";
            snap.forEach(doc => {
                const m = doc.data();
                const mid = doc.id;
                
                // Logic to check local storage for payment status (since login is removed)
                const isPaid = localStorage.getItem(`paid_${mid}`);
                const status = localStorage.getItem(`status_${mid}`) || 'none';

                let actionArea = '';
                if(status === 'approved') {
                    actionArea = `
                        <div class="room-info">
                            <span style="font-size:0.7rem; color:var(--primary);">ROOM DETAILS</span>
                            <div style="font-size:0.85rem;">ID: ${m.roomId || 'Wait...'}</div>
                            <div style="font-size:0.85rem;">Pass: ${m.password || 'Wait...'}</div>
                        </div>`;
                } else if(status === 'pending') {
                    actionArea = `<div style="color:var(--gold); font-size:0.8rem; margin-top:10px;">Verifying Payment...</div>`;
                } else {
                    actionArea = `<button class="btn-join" onclick="openPay('${mid}', ${m.entry})">JOIN NOW</button>`;
                }

                container.innerHTML += `
                <div class="card">
                    <div class="card-top">
                        <span style="font-size:0.75rem; color:#666;">Tournament #${mid.substring(0,5)}</span>
                        <span class="status-tag">${m.status.toUpperCase()}</span>
                    </div>
                    <div class="card-content">
                        <div class="left-data">
                            <div class="data-row">Map: <b>${m.map}</b></div>
                            <div class="data-row">Type: <b>${m.type}</b></div>
                            <div class="data-row">Entry: <b>₹${m.entry}</b></div>
                            <div class="data-row">Prize: <b>₹${m.win}</b></div>
                        </div>
                        <div class="right-data">
                            <div class="timer-box" id="t-${mid}">
                                <small>Starts In</small>
                                <span class="time-val">--:--</span>
                            </div>
                            <div class="progress-bar"><div class="progress-fill" style="width:${(m.joined/m.total)*100}%"></div></div>
                            <div class="slot-info">${m.joined}/${m.total} Slots</div>
                            ${actionArea}
                        </div>
                    </div>
                </div>`;

                // Live Timer Logic
                setInterval(() => {
                    const timerSpan = document.querySelector(`#t-${mid} .time-val`);
                    if(timerSpan && m.startTime) {
                        const diff = m.startTime - Date.now();
                        if(diff <= 0) { timerSpan.innerText = "LIVE"; timerSpan.style.color = "#ff4444"; }
                        else {
                            const min = Math.floor((diff % 3600000) / 60000);
                            const sec = Math.floor((diff % 60000) / 1000);
                            timerSpan.innerText = `${min}m ${sec}s`;
                        }
                    }
                }, 1000);
            });
        });

        // Payment Submitting
        window.submitUTR = async () => {
            const utr = document.getElementById('utr-field').value;
            if(utr.length < 10) return alert("Invalid UTR");
            
            await addDoc(collection(db, "payments"), {
                matchId: activeMatchId,
                utr: utr,
                status: 'pending',
                time: Date.now()
            });

            localStorage.setItem(`paid_${activeMatchId}`, 'true');
            localStorage.setItem(`status_${activeMatchId}`, 'pending');
            alert("Payment Sent to Admin! It will be approved soon.");
            closePay();
            location.reload();
        };

        window.openPay = (id, amt) => {
            activeMatchId = id;
            document.getElementById('p-amt').innerText = "₹" + amt;
            document.getElementById('pay-modal').style.display = 'flex';
        };

        window.closePay = () => { document.getElementById('pay-modal').style.display = 'none'; };

    </script>

    <script>
        function toggleMenu() { document.getElementById('side-menu').classList.toggle('active'); }
        
        function showPolicy() {
            alert("SQL REFUND POLICY:\n\n1. Agar match me players poore nahi hote, to match cancel kar diya jayega.\n2. Cancelled match ka paisa aapke account me 30 minute ke andar refund kar diya jayega.\n3. Kisi bhi takniki samasya (Technical Issue) ke liye WhatsApp support par message karen.");
        }

        // Google Translate
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
        }
    </script>
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>

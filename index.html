<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>SQL TOURNAMENT SYSTEM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <style>
        :root {
            --accent: #00ff88; /* High Contrast Green */
            --gold: #ffd700;
            --bg: #000000;
            --card: #0a0a0a;
            --border: #1a1a1a;
        }

        body { margin: 0; background: var(--bg); color: #ffffff; font-family: 'Inter', system-ui, -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; }

        /* Header Area */
        header { display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; background: var(--bg); border-bottom: 1px solid var(--gold); position: sticky; top: 0; z-index: 1000; }
        .branding h1 { color: var(--gold); margin: 0; font-size: 1.3rem; font-weight: 900; letter-spacing: 1px; }
        .branding p { color: #888; margin: 0; font-size: 0.75rem; font-weight: 500; }
        .menu-icon { font-size: 1.6rem; color: var(--gold); cursor: pointer; }

        /* Match Banner (As per your request - Small & Placed Below Header) */
        .match-banner { width: 92%; margin: 15px auto 5px; height: 90px; background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://wallpaperaccess.com/full/1151163.jpg'); background-size: cover; background-position: center; border-radius: 12px; border: 1px solid #333; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .match-banner h2 { font-size: 1rem; color: #fff; text-shadow: 2px 2px 4px #000; letter-spacing: 2px; }

        /* Drawer Menu */
        #drawer { position: fixed; top: 0; right: -100%; width: 280px; height: 100%; background: #050505; border-left: 1px solid var(--gold); transition: 0.3s ease-in-out; z-index: 2000; padding-top: 60px; box-shadow: -10px 0 30px rgba(0,0,0,0.8); }
        #drawer.active { right: 0; }
        .close-drawer { position: absolute; top: 20px; left: 20px; font-size: 2rem; color: #fff; cursor: pointer; }
        
        .nav-link { display: flex; align-items: center; padding: 18px 25px; color: #fff; text-decoration: none; border-bottom: 1px solid #111; font-weight: 600; }
        .nav-link i { margin-right: 15px; color: var(--gold); width: 20px; text-align: center; }
        #google_translate_element { margin: 20px; }

        /* Tournament Card Logic */
        #matches-list { padding: 15px; }
        .match-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; margin-bottom: 20px; position: relative; overflow: hidden; }
        
        .badge { position: absolute; top: 12px; right: 12px; font-size: 0.65rem; font-weight: 800; padding: 4px 10px; border-radius: 6px; text-transform: uppercase; color: #000; background: var(--accent); box-shadow: 0 0 10px rgba(0, 255, 136, 0.3); }

        .card-body { display: flex; padding: 20px 15px; gap: 12px; }
        
        /* Left: Admin Data */
        .match-details { flex: 1.2; display: flex; flex-direction: column; gap: 10px; border-right: 1px solid #1a1a1a; }
        .detail-item { display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; padding-right: 10px; }
        .detail-item span { color: #aaa; font-weight: 400; }
        .detail-item b { color: var(--accent); font-weight: 700; }

        /* Right: Interactive Area */
        .match-action { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .countdown { color: var(--gold); margin-bottom: 10px; text-align: center; }
        .countdown small { display: block; font-size: 0.6rem; color: #555; text-transform: uppercase; margin-bottom: 2px; }
        .countdown .time { font-size: 1.1rem; font-weight: 900; font-family: 'Courier New', monospace; }

        .slot-stat { font-size: 0.75rem; color: #777; width: 100%; text-align: center; margin-bottom: 5px; }
        .slot-bar { width: 100%; height: 6px; background: #1a1a1a; border-radius: 10px; margin-bottom: 15px; overflow: hidden; }
        .slot-fill { height: 100%; background: var(--accent); border-radius: 10px; transition: 1s ease; }

        /* Join Button Premium Styling */
        .btn-main { background: var(--accent); color: #000; border: none; padding: 12px; border-radius: 10px; font-weight: 800; font-size: 0.9rem; width: 100%; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 15px rgba(0, 255, 136, 0.2); }
        .btn-main:active { transform: scale(0.96); }
        .btn-main:disabled { background: #222; color: #555; box-shadow: none; cursor: not-allowed; }

        /* Room ID Details */
        .room-access { background: #001a0d; border: 1px solid var(--accent); border-radius: 10px; padding: 10px; width: 100%; margin-top: 5px; }
        .room-access div { font-size: 0.8rem; color: var(--accent); margin-bottom: 3px; }

        /* Payment Interface */
        #payment-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 3000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .pay-container { background: #0d0d0d; border: 1px solid var(--gold); border-radius: 20px; width: 100%; max-width: 350px; padding: 25px; text-align: center; }
        .pay-header { color: var(--gold); font-size: 1.2rem; font-weight: 800; margin-bottom: 20px; }
        .pay-input { width: 100%; padding: 15px; background: #000; border: 1px solid #222; border-radius: 12px; color: var(--accent); font-size: 1rem; margin-bottom: 20px; box-sizing: border-box; text-align: center; }
        .btn-submit { background: var(--gold); color: #000; border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: 900; font-size: 1rem; cursor: pointer; }

    </style>
</head>
<body>

    <header>
        <div class="branding">
            <h1>SQL TOURNAMENT</h1>
            <p>Join Play Win Real Money ðŸ’°</p>
        </div>
        <div class="menu-icon" onclick="toggleMenu()"><i class="fas fa-bars-staggered"></i></div>
    </header>

    <div class="match-banner">
        <h2><i class="fas fa-crosshairs"></i> FREE FIRE BATTLE</h2>
    </div>

    <div id="drawer">
        <div class="close-drawer" onclick="toggleMenu()">&times;</div>
        <a href="#" onclick="location.reload()" class="nav-link"><i class="fas fa-house"></i> HOME</a>
        <a href="#" onclick="openPolicy()" class="nav-link"><i class="fas fa-file-contract"></i> POLICY & REFUND</a>
        <a href="https://wa.me/919012277862" class="nav-link"><i class="fab fa-whatsapp"></i> WHATSAPP SUPPORT</a>
        <div id="google_translate_element"></div>
    </div>

    <main id="matches-list">
        </main>

    <div id="payment-modal">
        <div class="pay-container">
            <div class="pay-header">UTR VERIFICATION</div>
            <p style="font-size: 0.8rem; color: #888; margin-bottom: 15px;">Amount to pay: <span id="pay-amt" style="color:var(--accent); font-weight:800;">â‚¹0</span></p>
            <div style="background:#fff; width:180px; height:180px; margin: 0 auto 20px; border-radius:10px; display:flex; align-items:center; justify-content:center; color:#000;">
                <i class="fas fa-qrcode fa-5x"></i>
            </div>
            <input type="text" id="utr-box" class="pay-input" placeholder="ENTER 12-DIGIT UTR" maxlength="12">
            <button class="btn-submit" onclick="confirmPayment()">SUBMIT PAYMENT</button>
            <p onclick="closePay()" style="margin-top:20px; color:#555; cursor:pointer; font-size:0.9rem;">Cancel Transaction</p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBvObxADcAior6R_or9O6UmWsFT8do1GkI",
            authDomain: "sqladmin-ff04d.firebaseapp.com",
            projectId: "sqladmin-ff04d",
            storageBucket: "sqladmin-ff04d.firebasestorage.app",
            messagingSenderId: "539086978850",
            appId: "1:539086978850:web:261e6a0cf3c9a2aa29ef7b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let selectedId = null;

        onSnapshot(collection(db, "matches"), snap => {
            const list = document.getElementById('matches-list');
            list.innerHTML = "";
            snap.forEach(doc => {
                const data = doc.data();
                const id = doc.id;
                const statusLocal = localStorage.getItem(`status_${id}`) || 'none';

                let actionHtml = '';
                if(statusLocal === 'approved') {
                    actionHtml = `
                        <div class="room-access">
                            <div><i class="fas fa-id-badge"></i> ID: ${data.roomId || 'Wait...'}</div>
                            <div><i class="fas fa-lock"></i> PS: ${data.password || 'Wait...'}</div>
                        </div>`;
                } else if(statusLocal === 'pending') {
                    actionHtml = `<div style="color:var(--gold); font-size:0.75rem; text-align:center; margin-top:10px;"><i class="fas fa-spinner fa-spin"></i> Checking UTR...</div>`;
                } else {
                    actionHtml = `<button class="btn-main" onclick="openPayment('${id}', ${data.entry})"><i class="fas fa-bolt"></i> JOIN NOW</button>`;
                }

                list.innerHTML += `
                <div class="match-card">
                    <div class="badge">${data.status}</div>
                    <div class="card-body">
                        <div class="match-details">
                            <div class="detail-item"><span><i class="fas fa-map-location-dot"></i> Map</span> <b>${data.map}</b></div>
                            <div class="detail-item"><span><i class="fas fa-users"></i> Type</span> <b>${data.type}</b></div>
                            <div class="detail-item"><span><i class="fas fa-ticket"></i> Entry</span> <b>â‚¹${data.entry}</b></div>
                            <div class="detail-item"><span><i class="fas fa-trophy"></i> Prize</span> <b>â‚¹${data.win}</b></div>
                        </div>
                        <div class="match-action">
                            <div class="countdown" id="timer-${id}">
                                <small>Starts In</small>
                                <span class="time">00:00:00</span>
                            </div>
                            <div class="slot-stat">${data.joined}/${data.total} Slots</div>
                            <div class="slot-bar"><div class="slot-fill" style="width:${(data.joined/data.total)*100}%"></div></div>
                            ${actionHtml}
                        </div>
                    </div>
                </div>`;

                // Timer Update
                setInterval(() => {
                    const timerEl = document.querySelector(`#timer-${id} .time`);
                    if(timerEl && data.startTime) {
                        const now = Date.now();
                        const diff = data.startTime - now;
                        if(diff < 0) { timerEl.innerText = "STARTED"; timerEl.style.color = "red"; }
                        else {
                            const m = Math.floor((diff % 3600000) / 60000);
                            const s = Math.floor((diff % 60000) / 1000);
                            timerEl.innerText = `${m}m ${s}s`;
                        }
                    }
                }, 1000);
            });
        });

        window.openPayment = (id, amt) => {
            selectedId = id;
            document.getElementById('pay-amt').innerText = "â‚¹" + amt;
            document.getElementById('payment-modal').style.display = 'flex';
        };

        window.confirmPayment = async () => {
            const utr = document.getElementById('utr-box').value;
            if(utr.length < 12) return alert("Error: 12-Digit UTR is required!");
            
            await addDoc(collection(db, "payments"), {
                matchId: selectedId,
                utr: utr,
                status: 'pending',
                timestamp: Date.now()
            });

            localStorage.setItem(`status_${selectedId}`, 'pending');
            alert("UTR submitted! Hamari team ise verify karke 5-10 min me approve kar degi.");
            location.reload();
        };

        window.closePay = () => { document.getElementById('payment-modal').style.display = 'none'; };
    </script>

    <script>
        function toggleMenu() { document.getElementById('drawer').classList.toggle('active'); }
        
        function openPolicy() {
            alert("SQL RULES & REFUND:\n\n1. Game mein Rules break karne par ban mil sakta hai.\n2. Agar match players ki kami se cancel hota hai, toh 30 minat (minutes) ke andar refund received ho jayega.\n3. Technical issues ya kisi bhi samasya par WhatsApp support par message karein.");
        }

        function googleTranslateElementInit() {
            new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
        }
    </script>
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
    </html>

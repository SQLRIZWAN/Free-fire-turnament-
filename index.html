<!DOCTYPE html><html lang="en">
<head>
    <meta charset="utf-8" />
    <title>SQL TOURNAMENT PRO</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00ff88; --gold: #ffd700; --bg: #050505; --card: #121212; --border: #222; --red: #ff4444; --muted:#888; --waiting:#ffae00; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Poppins', sans-serif; overflow-x: hidden; }
        .allow-select { user-select: text !important; }

        /* Header */
        header { background: #000; padding: 15px; border-bottom: 2px solid var(--gold); text-align: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 4px 20px rgba(255, 215, 0, 0.1); }
        .header-title { color: var(--gold); font-weight: 800; font-size: 0.95rem; margin: 0; letter-spacing: 0.5px; text-transform: uppercase; }
        .menu-btn { position: absolute; right: 20px; top: 18px; color: var(--gold); font-size: 1.4rem; cursor: pointer; }

        /* Tabs */
        .tabs { display: flex; gap:8px; margin: 12px; background: #111; border-radius: 12px; border:1px solid var(--border); padding:6px; align-items:center; }
        .tab { flex: 1; padding: 10px; border: none; background: none; color: var(--muted); font-weight: 700; font-size: 0.8rem; cursor: pointer; transition: 0.2s; text-align:center; border-radius:10px; }
        .tab.active { background: var(--accent); color: #000; box-shadow: 0 0 10px var(--accent); }

        /* Match Card */
        #app-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); gap: 15px; padding: 10px 12px 90px 12px; }
        .card { background: var(--card); border-radius: 18px; border:1px solid var(--border); overflow: hidden; position: relative; }
        .m-tag { position: absolute; top: 12px; right: 15px; font-size: 0.65rem; background:#000; padding:4px 8px; border:1px solid var(--accent); border-radius:6px; color:var(--accent); font-weight:800; }
        .card-body { padding: 16px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items:center; }
        .item { display:flex; gap:10px; align-items:center; }
        .item i { color: var(--gold); font-size:1rem; width:20px; text-align:center; }
        .item div span { display:block; font-size:0.6rem; color:var(--muted); text-transform:uppercase; }
        .item div b { font-size:0.95rem; color:#fff; }
        
        .timer-box { background:#080808; padding:10px; text-align:center; border-top:1px solid #222; border-bottom:1px solid #222; }
        .countdown { font-family: monospace; font-size:1.2rem; color:var(--waiting); font-weight:900; letter-spacing:1px; }

        .card-footer { padding:14px; }
        .slots { display:flex; justify-content:space-between; font-size:0.75rem; margin-bottom:8px; font-weight:800; }
        .bar { height:8px; background:#222; border-radius:12px; overflow:hidden; margin-bottom:12px; }
        .fill { height:100%; background:linear-gradient(90deg, var(--accent), #008f4c); transition:1s ease; }

        .btn-main { width:100%; padding:14px; border-radius:12px; border:none; font-weight:900; font-size:1rem; cursor:pointer; transition:0.2s; text-transform:uppercase; }
        .btn-join { background:var(--accent); color:#000; box-shadow:0 0 15px rgba(0,255,136,0.2); }
        .btn-dis { background:#222; color:var(--muted); cursor:not-allowed; border:1px solid #333; }

        /* Room Box */
        .room-box { background: rgba(0, 255, 136, 0.05); border:1px dashed var(--accent); padding:15px; border-radius:12px; text-align:center; margin-bottom:10px; }
        .room-data { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
        .room-data div { background:#000; padding:10px; border-radius:8px; border:1px solid #333; }
        .room-data b { font-size:1rem; color:#fff; font-family:monospace; user-select: text !important; }

        /* Profile & Wallet */
        .profile-head { background: #111; padding:20px; border-radius:16px; text-align:center; border:1px solid #333; margin-bottom:20px; }
        .stats-box { display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:20px; }
        .stat-item { background:#0b0b0b; padding:10px; border-radius:10px; border:1px solid #222; text-align:center; }
        .stat-val { font-size:1.1rem; font-weight:800; color:var(--gold); }
        .wallet-actions { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
        .w-act-btn { padding:12px; border-radius:12px; border:1px solid #333; background:#111; color:#fff; font-weight:bold; cursor:pointer; }

        /* Modals */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 6000; display:none; align-items:center; justify-content:center; padding:15px; backdrop-filter: blur(5px); }
        .modal-ui { background:#111; width:100%; max-width:480px; padding:25px; border-radius:20px; border:1px solid var(--gold); color:#fff; position:relative; }
        input, select { width:100%; background:#050505; border:1px solid #333; color:#fff; padding:12px; border-radius:10px; outline:none; margin-bottom:10px; }
        
        /* Result Card */
        .result-card { background:#121212; border-radius:16px; margin-bottom:15px; overflow:hidden; border:1px solid #222; }
        .r-head { padding:12px; background:#080808; display:flex; justify-content:space-between; }
        .winner-box { background: linear-gradient(45deg, #ffd70010, transparent); border-left:3px solid var(--gold); padding:10px; }

        /* Side Menu */
        #side-menu { position: fixed; top:0; right:-100%; width:300px; height:100%; background:#000; z-index:5000; transition:0.4s; border-left:1px solid var(--gold); padding:20px; }
        #side-menu.active { right:0; }
        .menu-link { display:block; padding:15px; color:#fff; text-decoration:none; border-bottom:1px solid #222; }
    </style>
</head>
<body>

<header>
    <p class="header-title">PRO GAMING ZONE</p>
    <div class="menu-btn" onclick="toggleMenu(true)"><i class="fas fa-bars"></i></div>
</header>

<div class="tabs">
    <button class="tab active" id="tab-live" onclick="switchTab('live')">MATCHES</button>
    <button class="tab" id="tab-my" onclick="switchTab('my')">PROFILE</button>
    <button class="tab" id="tab-result" onclick="switchTab('result')">RESULTS</button>
</div>

<div id="side-menu">
    <h3 style="color:var(--gold)">MENU</h3>
    <a href="#" class="menu-link" onclick="location.reload()">Home</a>
    <a href="#" class="menu-link" onclick="openAuthModal('login')">Login / Register</a>
    <a href="#" class="menu-link" onclick="toggleMenu(false)">Close</a>
</div>

<main id="app-content"></main>

<div id="wallet-modal" class="modal">
    <div class="modal-ui">
        <h3 id="wallet-modal-title" style="color:var(--gold); text-align:center;">ADD FUND</h3>
        
        <div id="add-fund-form">
            <input type="number" id="manual-amt" placeholder="Amount (e.g. 50)">
            <button class="btn-main btn-join" onclick="initWalletDeposit()">PAY & ADD</button>
        </div>

        <div id="withdraw-form" style="display:none;">
            <input type="number" id="with-amt" placeholder="Amount (Min ₹50)">
            <input type="text" id="with-upi" placeholder="Your UPI ID">
            <p style="font-size:0.7rem; color:#666;">Money will be sent within 24 hours.</p>
            <button class="btn-main" style="background:var(--gold); color:#000;" onclick="submitWithdrawal()">WITHDRAW NOW</button>
        </div>
        <button onclick="document.getElementById('wallet-modal').style.display='none'" style="width:100%; background:none; border:none; color:#555; margin-top:10px;">CLOSE</button>
    </div>
</div>

<div id="pay-modal" class="modal">
    <div class="modal-ui">
        <h3 style="color:var(--gold); text-align:center;">CONFIRM</h3>
        <h1 id="modal-amt" style="color:var(--accent); text-align:center;">₹0</h1>
        
        <div id="wallet-pay-btn-box" style="margin-bottom:15px; text-align:center;">
            <button class="btn-main btn-join" onclick="payViaWallet()">PAY FROM WALLET</button>
            <div style="margin:10px 0; font-size:0.8rem;">--- OR UPI ---</div>
        </div>

        <a id="upi-link" href="#" class="btn-main" style="display:block; text-align:center; background:#222; color:#fff; text-decoration:none; margin-bottom:10px;">PAY VIA UPI APP</a>
        
        <input type="text" id="utr-input" placeholder="Enter UTR / Ref No">
        <input type="file" id="utr-ss" accept="image/*">
        <button class="btn-main btn-join" id="submit-pay-btn" onclick="processPayment()">SUBMIT PROOF</button>
        <button onclick="document.getElementById('pay-modal').style.display='none'" style="width:100%; background:none; border:none; color:#555; margin-top:10px;">CANCEL</button>
    </div>
</div>

<div id="auth-modal" class="modal">
    <div class="modal-ui">
        <h2 id="auth-title" style="color:var(--gold); text-align:center;">LOGIN</h2>
        <div id="auth-forms"></div>
        <button id="auth-submit-btn" class="btn-main btn-join" style="margin-top:15px;" onclick="submitAuth()">LOGIN</button>
        <p id="auth-toggle-msg" style="text-align:center; font-size:0.8rem; margin-top:15px; cursor:pointer;" onclick="toggleAuthMode()">New user? Register Here</p>
        <button onclick="document.getElementById('auth-modal').style.display='none'" style="position:absolute; top:10px; right:10px; background:none; border:none; color:#fff;">X</button>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import {
        getFirestore, collection, onSnapshot, addDoc, query, where,
        orderBy, limit, getDocs, doc, setDoc, getDoc, updateDoc, increment, runTransaction, arrayUnion
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // --- YOUR CONFIG (AUTO INSERTED) ---
    const firebaseConfig = {
        apiKey: "AIzaSyBvObxADcAior6R_or9O6UmWsFT8do1GkI",
        authDomain: "sqladmin-ff04d.firebaseapp.com",
        projectId: "sqladmin-ff04d",
        storageBucket: "sqladmin-ff04d.firebasestorage.app",
        messagingSenderId: "539086978850",
        appId: "1:539086978850:web:261e6a0cf3c9a2aa29ef7b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- VARIABLES ---
    let activeTab = 'live';
    let currentAuthMode = 'login';
    let activeMatchId = null;
    let activeEntryFee = 0;
    let currentUserBal = 0;

    // --- HELPERS ---
    function loadSession(){ try { return JSON.parse(localStorage.getItem('sql_session') || "null"); } catch { return null; } }
    function saveSession(data){ localStorage.setItem('sql_session', JSON.stringify(data)); }

    async function uploadToCloudinary(file){
        if(!file) return "";
        const fd = new FormData(); fd.append("file", file); fd.append("upload_preset", "sql_admin"); // YOUR PRESET
        try {
            const res = await fetch("https://api.cloudinary.com/v1_1/debp1kjtm/image/upload", { method:"POST", body: fd });
            const data = await res.json(); return data.secure_url || "";
        } catch(e) { console.error(e); return ""; }
    }

    // --- AUTH ---
    window.openAuthModal = (mode) => {
        document.getElementById('auth-modal').style.display = 'flex';
        currentAuthMode = mode;
        renderAuthForm();
    };
    window.toggleAuthMode = () => { currentAuthMode = currentAuthMode==='login'?'register':'login'; renderAuthForm(); };

    function renderAuthForm(){
        const ui = document.getElementById('auth-forms');
        const title = document.getElementById('auth-title');
        const msg = document.getElementById('auth-toggle-msg');
        const btn = document.getElementById('auth-submit-btn');

        if(currentAuthMode === 'login'){
            title.innerText = "LOGIN"; btn.innerText = "LOGIN"; msg.innerText = "New user? Register Here";
            ui.innerHTML = `<input id="login_phone" type="number" placeholder="Phone"><input id="login_pass" type="password" placeholder="Password">`;
        } else {
            title.innerText = "REGISTER"; btn.innerText = "REGISTER"; msg.innerText = "Have account? Login Here";
            ui.innerHTML = `<input id="reg_name" type="text" placeholder="Name"><input id="reg_phone" type="number" placeholder="Phone"><input id="reg_gaming" type="text" placeholder="Gaming UID/Name"><input id="reg_pass" type="password" placeholder="Password">`;
        }
    }

    window.submitAuth = async () => {
        const btn = document.getElementById('auth-submit-btn'); btn.disabled=true; btn.innerText="Processing...";
        try {
            if(currentAuthMode === 'register'){
                const phone = document.getElementById('reg_phone').value;
                if(!phone || phone.length!==10) throw "Invalid Phone";
                const snap = await getDoc(doc(db,"users",phone));
                if(snap.exists()) throw "User Exists!";
                
                const u = { name: document.getElementById('reg_name').value, phone, gamingName: document.getElementById('reg_gaming').value, password: document.getElementById('reg_pass').value, balance:0 };
                await setDoc(doc(db,"users",phone), u);
                saveSession(u);
            } else {
                const phone = document.getElementById('login_phone').value;
                const snap = await getDoc(doc(db,"users",phone));
                if(!snap.exists()) throw "User Not Found";
                const d = snap.data();
                if(d.password !== document.getElementById('login_pass').value) throw "Wrong Password";
                saveSession(d);
            }
            document.getElementById('auth-modal').style.display='none';
            renderUI();
        } catch(e){ alert(e); }
        btn.disabled=false; btn.innerText = currentAuthMode==='login'?"LOGIN":"REGISTER";
    };

    // --- MAIN UI ---
    window.switchTab = (t) => {
        activeTab = t;
        document.querySelectorAll('.tab').forEach(b => b.classList.remove('active'));
        document.getElementById(`tab-${t}`).classList.add('active');
        renderUI();
    };

    function renderUI(){
        const c = document.getElementById('app-content'); c.innerHTML = "";
        if(activeTab === 'live') renderLiveMatches(c);
        else if(activeTab === 'my') renderProfile(c);
        else if(activeTab === 'result') renderResults(c);
    }

    // --- LIVE MATCHES ---
    function renderLiveMatches(container){
        onSnapshot(collection(db, "matches"), (snap) => {
            if(activeTab !== 'live') return;
            container.innerHTML = "";
            const matches = [];
            snap.forEach(d => matches.push({id:d.id, ...d.data()}));
            matches.sort((a,b) => a.startTime - b.startTime);

            matches.forEach(m => {
                const isFull = (m.joined||0) >= (m.total||48);
                const s = loadSession();
                const myRec = s ? localStorage.getItem(`pay_${m.id}`) : null;
                const recData = myRec ? JSON.parse(myRec) : null;
                
                let btnHTML = "";
                let roomHTML = "";

                // Check if user is approved inside the match document (Source of Truth)
                const isApproved = s && m.approvedUtrs && m.approvedUtrs.includes(recData?.utr || 'WALLET');

                if(isApproved){
                     if(m.status === 'started' || (Date.now() > m.startTime)){
                        roomHTML = `<div class="room-box"><div class="room-data"><div>ID: <b>${m.roomId}</b></div><div>PASS: <b>${m.password}</b></div></div></div>`;
                        btnHTML = `<button class="btn-main btn-dis">STARTED</button>`;
                     } else {
                        btnHTML = `<button class="btn-main btn-dis">JOINED</button>`;
                     }
                } else if(recData && recData.status === 'pending'){
                    btnHTML = `<button class="btn-main btn-dis">VERIFYING...</button>`;
                } else {
                    if(isFull) btnHTML = `<button class="btn-main btn-dis">FULL</button>`;
                    else btnHTML = `<button class="btn-main btn-join" onclick="initPayment('${m.id}', ${m.entry})">JOIN ₹${m.entry}</button>`;
                }

                container.innerHTML += `
                <div class="card">
                    <div class="m-tag">${m.map}</div>
                    <div class="card-body">
                        <div class="item"><div><span>TYPE</span><b>${m.type}</b></div></div>
                        <div class="item"><div><span>WIN</span><b style="color:var(--accent)">₹${m.win}</b></div></div>
                        <div class="item"><div><span>ENTRY</span><b style="color:var(--gold)">₹${m.entry}</b></div></div>
                        <div class="item"><div><span>TIME</span><b>${new Date(m.startTime).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</b></div></div>
                    </div>
                    <div class="card-footer">
                        <div class="slots"><span>${m.joined}/${m.total}</span><span>Left: ${m.total-m.joined}</span></div>
                        <div class="bar"><div class="fill" style="width:${(m.joined/m.total)*100}%"></div></div>
                        ${roomHTML}
                        ${btnHTML}
                    </div>
                </div>`;
            });
        });
    }

    // --- PROFILE & WALLET LOGIC (FIXED) ---
    async function renderProfile(c){
        const s = loadSession();
        if(!s) return c.innerHTML = `<button class="btn-main btn-join" onclick="openAuthModal('login')">LOGIN TO VIEW</button>`;
        
        // Listen to real balance
        onSnapshot(doc(db,"users",s.phone), (d) => {
            if(d.exists()) {
                currentUserBal = d.data().balance || 0;
                document.getElementById('disp-bal').innerText = "₹" + currentUserBal.toFixed(2);
            }
        });

        c.innerHTML = `
        <div class="profile-head">
            <h3>${s.name}</h3>
            <p style="color:#666">${s.phone}</p>
            <div class="stats-box">
                <div class="stat-item"><span style="font-size:0.7rem;">BALANCE</span><br><span class="stat-val" id="disp-bal">Loading...</span></div>
            </div>
            <div class="wallet-actions">
                <button class="w-act-btn" onclick="openWalletModal('add')">ADD FUND</button>
                <button class="w-act-btn" onclick="openWalletModal('with')">WITHDRAW</button>
            </div>
        </div>
        <div style="padding:10px;"><h4 style="color:var(--gold)">History</h4><div id="hist-list">Loading...</div></div>`;
        
        loadHistory();
    }

    window.openWalletModal = (t) => {
        document.getElementById('wallet-modal').style.display='flex';
        document.getElementById('add-fund-form').style.display = t==='add'?'block':'none';
        document.getElementById('withdraw-form').style.display = t==='with'?'block':'none';
    };

    window.initWalletDeposit = () => {
        const amt = document.getElementById('manual-amt').value;
        if(!amt) return;
        document.getElementById('wallet-modal').style.display='none';
        initPayment("ADD_FUND", amt);
    };

    // --- FIXED WITHDRAWAL (Deduct First) ---
    window.submitWithdrawal = async () => {
        const amt = Number(document.getElementById('with-amt').value);
        const upi = document.getElementById('with-upi').value;
        const s = loadSession();
        
        if(amt > currentUserBal) return alert("Insufficient Balance");
        if(amt < 50) return alert("Min ₹50");

        if(confirm(`Withdraw ₹${amt}? Money will be deducted.`)){
            try {
                // 1. Deduct Balance Immediately
                await updateDoc(doc(db,"users",s.phone), { balance: increment(-amt) });
                // 2. Create Request
                await addDoc(collection(db,"withdrawals"), {
                    userId: s.phone, userName: s.name, amount: amt, upi: upi, status: 'pending', timestamp: Date.now()
                });
                alert("Withdrawal Requested!");
                document.getElementById('wallet-modal').style.display='none';
            } catch(e) { alert("Error: " + e.message); }
        }
    };

    // --- PAYMENT FLOW ---
    window.initPayment = (mid, amt) => {
        const s = loadSession(); if(!s) return openAuthModal('login');
        activeMatchId = mid; activeEntryFee = parseFloat(amt);
        document.getElementById('modal-amt').innerText = "₹" + amt;
        document.getElementById('pay-modal').style.display = 'flex';
        
        if(mid === 'ADD_FUND') document.getElementById('wallet-pay-btn-box').style.display='none';
        else document.getElementById('wallet-pay-btn-box').style.display='block';
        
        const upiLink = `upi://pay?pa=rizwanhasan90122778623@ybl&am=${amt}&tn=Pay_${mid}`;
        document.getElementById('upi-link').href = upiLink;
    };

    // --- FIXED WALLET JOIN (Safe Transaction) ---
    window.payViaWallet = async () => {
        const s = loadSession();
        if(currentUserBal < activeEntryFee) return alert("Low Balance! Please Add Fund.");
        
        if(confirm(`Pay ₹${activeEntryFee} from Wallet?`)){
            try {
                // Run as atomic transaction
                await runTransaction(db, async (transaction) => {
                    const userRef = doc(db, "users", s.phone);
                    const uSnap = await transaction.get(userRef);
                    if(uSnap.data().balance < activeEntryFee) throw "Low Balance!";
                    
                    // Deduct
                    transaction.update(userRef, { balance: increment(-activeEntryFee) });
                    
                    // Add Payment Record
                    const payRef = doc(collection(db, "payments"));
                    transaction.set(payRef, {
                        matchId: activeMatchId, utr: "WALLET", ss: "WALLET",
                        userId: s.phone, userName: s.name, status: 'approved', timestamp: Date.now()
                    });
                    
                    // Update Match Participants directly
                    const matchRef = doc(db, "matches", activeMatchId);
                    transaction.update(matchRef, {
                        joined: increment(1),
                        approvedUtrs: arrayUnion("WALLET")
                    });
                });

                localStorage.setItem(`pay_${activeMatchId}`, JSON.stringify({status:'approved', utr:'WALLET'}));
                alert("Joined Successfully!");
                document.getElementById('pay-modal').style.display='none';
                renderUI();
            } catch(e) { alert(e); }
        }
    };

    window.processPayment = async () => {
        const utr = document.getElementById('utr-input').value;
        const f = document.getElementById('utr-ss').files[0];
        if(!utr || !f) return alert("Enter UTR & Screenshot");
        
        const btn = document.getElementById('submit-pay-btn'); btn.innerText="Uploading...";
        const url = await uploadToCloudinary(f);
        const s = loadSession();

        const payData = { matchId: activeMatchId, utr, ss: url, userId: s.phone, userName: s.name, status: 'pending', timestamp: Date.now() };
        await addDoc(collection(db,"payments"), payData);
        localStorage.setItem(`pay_${activeMatchId}`, JSON.stringify(payData));
        
        alert("Sent for Approval!");
        document.getElementById('pay-modal').style.display='none';
        btn.innerText="SUBMIT";
    };

    // --- RESULTS ---
    function renderResults(container){
        container.innerHTML = "Loading...";
        // Use client side sort to avoid index errors
        getDocs(collection(db,"results")).then(snap => {
            container.innerHTML = "";
            let res = [];
            snap.forEach(d => res.push(d.data()));
            res.sort((a,b) => b.timestamp - a.timestamp);
            
            res.forEach(r => {
                container.innerHTML += `
                <div class="result-card">
                    <div class="r-head"><span>${r.matchId || 'Match Result'}</span><span>${new Date(r.timestamp).toLocaleDateString()}</span></div>
                    ${r.image ? `<img src="${r.image}" style="width:100%">` : ''}
                    <div style="padding:15px">
                        <div class="winner-box">WINNER: <b style="color:var(--accent)">${r.winnerName}</b> (₹${r.winningAmount})</div>
                        <p style="font-size:0.8rem">${r.message || ''}</p>
                    </div>
                </div>`;
            });
        });
    }

    // --- HISTORY ---
    async function loadHistory(){
        const s = loadSession();
        const list = document.getElementById('hist-list');
        const snap = await getDocs(query(collection(db,"payments"), where("userId","==",s.phone)));
        const wSnap = await getDocs(query(collection(db,"withdrawals"), where("userId","==",s.phone)));
        
        let all = [];
        snap.forEach(d => all.push({...d.data(), type:'PAY'}));
        wSnap.forEach(d => all.push({...d.data(), type:'WITHDRAW'}));
        all.sort((a,b) => b.timestamp - a.timestamp);

        list.innerHTML = "";
        all.forEach(i => {
            let color = i.status==='approved'?'var(--accent)':'var(--waiting)';
            if(i.status === 'rejected') color = 'var(--red)';
            list.innerHTML += `
            <div style="background:#0b0b0b; padding:10px; margin-bottom:5px; border-radius:8px; border-left:3px solid ${color}">
                <div style="display:flex; justify-content:space-between">
                    <b>${i.type==='PAY' ? 'Payment' : 'Withdraw'}</b>
                    <b style="color:${color}">${i.status.toUpperCase()}</b>
                </div>
                <div style="font-size:0.8rem; color:#666">₹${i.amount} | ${new Date(i.timestamp).toLocaleDateString()}</div>
            </div>`;
        });
    }

    // Toggle Menu
    window.toggleMenu = (s) => document.getElementById('side-menu').classList.toggle('active', s);
    
    // Init
    renderUI();
</script>
</body>
</html>
